<?xml version="1.0"?>
<!-- 
  * build.xml
  *
  *      Authors: Matt Jones
  *    Copyright: 2000 Regents of the University of California and the
  *               National Center for Ecological Analysis and Synthesis
  *  For Details: http://www.nceas.ucsb.edu/
  *    File Info: '$Id: build.xml,v 1.10.2.1 2001-04-23 16:16:08 jones Exp $'
  *
  *  Build file for the Ant cross-platform build system for metacat
  *  See http://jakarta.apache.org for details on Ant
  *
  * usage: ant [compile|jar|install|jdoc]
--> 
<project name="metacat" default="install" basedir=".">
   <target name="init">
      <property name="installdir" value="/opt/tomcat/webapps/metadata" />
      <property name="name" value="dmanclient"/>
      <property name="Name" value="Data Management Client"/>
      <property name="release" value="0.00"/>

      <filter token="release" value="${release}"/>

      <property name="srcdir" value="./src" />
      <property name="libdir" value="./lib" />

      <property name="build.dir" value="./build"/>
      <property name="build.src" value="${build.dir}/src"/>
      <property name="build.dest" value="${build.dir}/classes"/>
      <property name="build.docs" value="${build.dir}/docs/html"/>
      <property name="build.samples" value="${build.dir}/samples"/>
      <property name="build.tests" value="${build.dir}/tests"/>
      <property name="build.data" value="${build.dir}/data"/>
      <property name="build.javadocs" value="${build.dir}/docs/apiDocs"/>

      <property name="xml4j" 
                value="${libdir}/xml4j.jar" />
      <property name="xerces" 
                value="${libdir}/xerces.jar" />
      <property name="xalan" 
                value="${libdir}/xalan.jar" />
      <property name="sym" 
                value="${libdir}/sym.jar" />
      <property name="cpath" 
                value="${xerces}:${xalan}:${xml4j}:${build.dest}:${sym}"/>
      <property name="package.home" value="edu/ucsb/nceas" />

   </target>
   
   <target name="prepare" depends="init">
      <mkdir dir="${build.dir}"/>
      <mkdir dir="${build.src}"/>
      <mkdir dir="${build.dest}"/>

      <copy todir="${build.src}" filtering="no">
        <fileset dir="${srcdir}">
          <exclude name="**/CVS*"/>
          <exclude name="**/.#*"/>
        </fileset>
      </copy>
   </target>

   <target name="compile" depends="prepare">

      <javac srcdir="${build.src}" 
             destdir="${build.dest}" 
             classpath="${cpath}" /> 
   </target> 

   <target name="jar" depends="compile">
      <delete file="${build.dir}/${name}.jar" />
      <copy todir="${build.dest}/${package.home}/metaedit" filtering="no">
        <fileset dir="${srcdir}/${package.home}/metaedit/images">
        </fileset>
      </copy>
      <copy todir="${build.dest}/${package.home}/dtclient" filtering="no">
        <fileset dir="${srcdir}/${package.home}/dtclient/images">
        </fileset>
      </copy>
      <copy todir="${build.dest}/${package.home}/querybean" filtering="no">
        <fileset dir="${srcdir}/${package.home}/querybean/images">
        </fileset>
      </copy>
      <jar jarfile="${build.dir}/${name}.jar" basedir="${build.dest}" />
   </target> 

   <target name="install" depends="jar">
      <copy file="${build.dir}/${name}.jar" todir="${libdir}" />
      <echo message="Install complete. Use the morpho script to run it." />
   </target> 

   <target name="clean" depends="init">
       <delete dir="${build.dir}" />
   </target>

   <target name="jdoc" depends="init">
       <mkdir dir="${build.javadocs}" />
       <javadoc packagenames="edu.ucsb.nceas"
           sourcepath="src"
           destdir="${build.javadocs}"
           author="true"
           version="true"
           use="true"
           windowtitle="${Name} API"
           doctitle="&lt;h1&gt;${Name}&lt;/h1&gt;"
           bottom="&lt;i&gt;Copyright &#169; 2000 National Center for Ecological Analysis and Synthesis. All Rights Reserved.&lt;/i&gt;"
       />
   </target>

</project>
